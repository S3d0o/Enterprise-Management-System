@using Demo.BusinessLogic.DTOS.DepartmentDTOS
@model IEnumerable<DepartmentDto>
@{
    ViewData["Title"] = "Index";
}

<partial name="_ToastPartialView"></partial>

@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const toastElList = [].slice.call(document.querySelectorAll('.toast'));
            toastElList.forEach(function (toastEl) {
                const toast = new bootstrap.Toast(toastEl, { delay: 5000 });
                toast.show();
            });
        });
    </script>
}

<h1 class="my-5 w-50 mx-auto text-center fw-bold border-bottom pb-3">All Departments</h1>
<div class="container">
    <form class="row justify-content-center align-items-center" asp-action="Index" method="get">
        <!-- Search -->
        <div class="col-md-6">
            <div class="input-group shadow rounded-pill">
                <input class="form-control border-0 rounded-pill rounded-end-0 px-3"
                       type="text"
                       id="searchBox"
                       name="DepartmentSearchName"
                       placeholder="Search By Department..."
                       aria-label="Search"
                       style="height: 50px; font-size: 1.1rem;" />
                <button class="btn btn-primary rounded-pill rounded-start-0 px-3"
                        type="submit"
                        id="searchButton"
                        style="height: 50px;">
                    <i class="bi bi-search"></i>
                </button>
            </div>
        </div>
        <!-- Create -->
        <div class="col-md-auto">
            <a class="btn btn-lg text-white px-4"
               style="background: linear-gradient(to right, #4a69bd, #1e3799);
                      border: none;
                      color: white;
                      font-size: 16px;
                      font-weight: 500;
                      border-radius: 8px;
                      box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.2);
                      transition: all 0.3s ease-in-out;
                      height: 50px; display: flex; align-items: center; justify-content: center;"
               onmouseover="this.style.background='linear-gradient(to right, #3c6382, #0c2461)'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0px 6px 10px rgba(0, 0, 0, 0.3)';"
               onmouseout="this.style.background='linear-gradient(to right, #4a69bd, #1e3799)'; this.style.transform='translateY(0px)'; this.style.boxShadow='0px 4px 6px rgba(0, 0, 0, 0.2)';"
               onmousedown="this.style.transform='translateY(1px)'; this.style.boxShadow='0px 2px 5px rgba(0, 0, 0, 0.2)';"
               onmouseup="this.style.transform='translateY(-2px)'; this.style.boxShadow='0px 6px 10px rgba(0, 0, 0, 0.3)';"
               asp-controller="Department" asp-action="Create">
                <i class="fas fa-building me-2"></i> Create
            </a>
        </div>
    </form>
</div>

<div class="container mt-3" style="min-height: 500px;">
    @if (Model?.Any() ?? false)
    {
        <table class="table table-striped table-hover shadow rounded-bottom">
            <thead class="text-center">
                <tr>
                    <th>@Html.DisplayNameFor(d => d.DeptCode)</th>
                    <th>@Html.DisplayNameFor(d => d.DeptName)</th>
                    <th>@Html.DisplayNameFor(d => d.DeptDescription)</th>
                    <th>@Html.DisplayNameFor(d => d.DateOfCreation)</th>
                    <th>Details</th>
                    <th>Edit</th>
                    <th>Delete</th>
                </tr>
            </thead>
            <tbody class="text-center">
                @foreach (var department in Model)
                {
                    <tr>
                        <td>@department.DeptCode</td>
                        <td>@department.DeptName</td>
                        <td>@(department.DeptDescription ?? "No Desc")</td>
                        <td>@department.DateOfCreation</td>
                            <!--Partial view for 3 buttons-->
                            <!-- Delete Modal -->
                        <partial name="_ButtonsPartialView"
                                 model="@department.DeptId"
                                 view-data='new ViewDataDictionary(ViewData) {
                                              { "EntityType", "Department" },
                                              { "Controller", "Department" },
                                              { "Name", department.DeptName }
                                          }' />
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <div class="alert alert-info text-center">
            <h2>No Departments Found</h2>
        </div>
    }
</div>